local REGIMENTS_OF_RENOWN = {
	----------------
	---- EMPIRE ----
	----------------
	["wh_main_sc_emp_empire"] = {
		playable_factions = {
			["main_warhammer"] = {
				"wh_main_emp_empire",
				"wh2_dlc13_emp_golden_order",
				"wh2_dlc13_emp_the_huntmarshals_expedition"
			},
			["wh2_main_great_vortex"] = {
				"wh2_dlc13_emp_the_huntmarshals_expedition"
			}
		},
		units = {
			"wh_dlc04_emp_art_hammer_of_the_witches_0",
			"wh_dlc04_emp_art_sunmaker_0",
			"wh_dlc04_emp_cav_royal_altdorf_gryphites_0",
			"wh_dlc04_emp_cav_zintlers_reiksguard_0",
			"wh_dlc04_emp_inf_sigmars_sons_0",
			"wh_dlc04_emp_inf_silver_bullets_0",
			"wh_dlc04_emp_inf_stirlands_revenge_0",
			"wh_dlc04_emp_inf_tattersouls_0",
			"wh_dlc04_emp_veh_templehof_luminark_0",
			"wh2_dlc13_emp_inf_halberdiers_ror_0",
			"wh2_dlc13_emp_inf_swordsmen_ror_0",
			"wh2_dlc13_emp_cav_outriders_ror_0",
			"wh2_dlc13_emp_art_mortar_ror_0",
			"wh2_dlc13_emp_inf_greatswords_ror_0",
			"wh2_dlc13_emp_inf_crossbowmen_ror_0",
			"wh2_dlc13_emp_cav_empire_knights_ror_0",
			"wh2_dlc13_emp_inf_spearmen_ror_0",
			"wh2_dlc13_emp_veh_steam_tank_ror_0",
			"wh2_dlc13_emp_cav_empire_knights_ror_1",
			"wh2_dlc13_emp_cav_pistoliers_ror_0",
			"wh2_dlc13_emp_inf_handgunners_ror_0",
			"wh2_dlc13_emp_cav_empire_knights_ror_2",
			"wh2_dlc13_emp_inf_archers_ror_0",
			"wh2_dlc13_emp_inf_huntsmen_ror_0",
			"wh2_dlc13_emp_veh_war_wagon_ror_0"
		}
	},
	------------------
	---- VAMPIRES ----
	------------------
	["wh_main_sc_vmp_vampire_counts"] = {
		playable_factions = {
			["main_warhammer"] = {
				"wh_main_vmp_vampire_counts",
				"wh_main_vmp_schwartzhafen",
				"wh2_dlc11_vmp_the_barrow_legion"
			}
		},
		units = {
			"wh_dlc04_vmp_cav_chillgheists_0",
			"wh_dlc04_vmp_cav_vereks_reavers_0",
			"wh_dlc04_vmp_inf_feasters_in_the_dusk_0",
			"wh_dlc04_vmp_inf_konigstein_stalkers_0",
			"wh_dlc04_vmp_inf_sternsmen_0",
			"wh_dlc04_vmp_inf_tithe_0",
			"wh_dlc04_vmp_mon_devils_swartzhafen_0",
			"wh_dlc04_vmp_mon_direpack_0",
			"wh_dlc04_vmp_veh_claw_of_nagash_0"
		}
	},
	----------------
	---- DWARFS ----
	----------------
	["wh_main_sc_dwf_dwarfs"] = {
		playable_factions = {
			["main_warhammer"] = {
				"wh_main_dwf_dwarfs",
				"wh_main_dwf_karak_izor",
				"wh_main_dwf_karak_kadrin",
				"wh2_dlc17_dwf_thorek_ironbrow"
			},
			["wh2_main_great_vortex"] = {
				"wh2_dlc17_dwf_thorek_ironbrow"
			}
		},
		units = {
			"wh_dlc06_dwf_art_gob_lobber_0",
			"wh_dlc06_dwf_inf_dragonback_slayers_0",
			"wh_dlc06_dwf_inf_ekrund_miners_0",
			"wh_dlc06_dwf_inf_norgrimlings_ironbreakers_0",
			"wh_dlc06_dwf_inf_norgrimlings_irondrakes_0",
			"wh_dlc06_dwf_inf_old_grumblers_0",
			"wh_dlc06_dwf_inf_peak_gate_guard_0",
			"wh_dlc06_dwf_inf_ulthars_raiders_0",
			"wh_dlc06_dwf_inf_warriors_dragonfire_pass_0",
			"wh_dlc06_dwf_veh_skyhammer_0"
		}
	},
	--------------------
	---- GREENSKINS ----
	--------------------
	["wh_main_sc_grn_greenskins"] = {
		playable_factions = {
			["main_warhammer"] = {
				"wh_main_grn_greenskins",
				"wh_main_grn_crooked_moon",
				"wh_main_grn_orcs_of_the_bloody_hand",
				"wh2_dlc15_grn_broken_axe"
			},
			["wh2_main_great_vortex"] = {
				"wh2_dlc15_grn_broken_axe"
			}
		},
		units = {
			"wh_dlc06_grn_art_hammer_of_gork_0",
			"wh_dlc06_grn_cav_broken_tusks_mob_0",
			"wh_dlc06_grn_cav_deff_creepers_0",
			"wh_dlc06_grn_cav_durkits_squigs_0",
			"wh_dlc06_grn_cav_mogrubbs_marauders_0",
			"wh_dlc06_grn_cav_moon_howlers_0",
			"wh_dlc06_grn_cav_teef_robbers_0",
			"wh_dlc06_grn_inf_da_eight_peaks_loonies_0",
			"wh_dlc06_grn_inf_da_rusty_arrers_0",
			"wh_dlc06_grn_inf_da_warlords_boyz_0",
			"wh_dlc06_grn_inf_krimson_killerz_0",
			"wh_dlc06_grn_mon_venom_queen_0",
			"wh2_dlc15_grn_mon_river_trolls_ror_0",
			"wh2_dlc15_grn_mon_rogue_idol_ror_0",
			"wh2_dlc15_grn_veh_snotling_pump_wagon_ror_0"
		}
	},
	-------------------
	---- BRETONNIA ----
	-------------------
	["wh_main_sc_brt_bretonnia"] = {
		playable_factions = {
			["main_warhammer"] = {
				"wh_main_brt_bretonnia",
				"wh_main_brt_bordeleaux",
				"wh_main_brt_carcassonne",
				"wh2_dlc14_brt_chevaliers_de_lyonesse"
			},
			["wh2_main_great_vortex"] = {
				"wh2_dlc14_brt_chevaliers_de_lyonesse"
			}
		},
		units = {
			"wh_pro04_brt_cav_knights_errant_ror_0",
			"wh_pro04_brt_cav_knights_of_the_realm_ror_0",
			"wh_pro04_brt_cav_mounted_yeomen_ror_0",
			"wh_pro04_brt_cav_questing_knights_ror_0",
			"wh_pro04_brt_inf_battle_pilgrims_ror_0",
			"wh_pro04_brt_inf_foot_squires_ror_0"
		}
	},
	--------------------
	---- TOMB KINGS ----
	--------------------
	["wh2_dlc09_sc_tmb_tomb_kings"] = {
		playable_factions = {
			["main_warhammer"] = {
				"wh2_dlc09_tmb_khemri",
				"wh2_dlc09_tmb_exiles_of_nehek",
				"wh2_dlc09_tmb_lybaras",
				"wh2_dlc09_tmb_followers_of_nagash"
			},
			["wh2_main_great_vortex"] = {
				"wh2_dlc09_tmb_khemri",
				"wh2_dlc09_tmb_exiles_of_nehek",
				"wh2_dlc09_tmb_lybaras",
				"wh2_dlc09_tmb_followers_of_nagash"
			}
		},
		units = {
			"wh2_dlc09_tmb_inf_skeleton_archers_ror",
			"wh2_dlc09_tmb_inf_skeleton_spearmen_ror",
			"wh2_dlc09_tmb_inf_tomb_guard_ror",
			"wh2_dlc09_tmb_mon_necrosphinx_ror",
			"wh2_dlc09_tmb_mon_sepulchral_stalkers_ror",
			"wh2_dlc09_tmb_mon_ushabti_ror"
		}
	},
	--------------------
	---- HIGH ELVES ----
	--------------------
	["wh2_main_sc_hef_high_elves"] = {
		playable_factions = {
			["main_warhammer"] = {
				"wh2_main_hef_avelorn",
				"wh2_main_hef_eataine",
				"wh2_main_hef_order_of_loremasters",
				"wh2_main_hef_nagarythe",
				"wh2_main_hef_yvresse",
				"wh2_main_hef_caledor"
			},
			["wh2_main_great_vortex"] = {
				"wh2_main_hef_avelorn",
				"wh2_main_hef_eataine",
				"wh2_main_hef_order_of_loremasters",
				"wh2_main_hef_nagarythe",
				"wh2_main_hef_yvresse",
				"wh2_main_hef_caledor"
			}
		},
		units = {
			"wh2_dlc10_hef_cav_the_fireborn_ror_0",
			"wh2_dlc10_hef_cav_the_heralds_of_the_wind_ror_0",
			"wh2_dlc10_hef_inf_everqueens_court_guards_ror_0",
			"wh2_dlc10_hef_inf_keepers_of_the_flame_ror_0",
			"wh2_dlc10_hef_inf_the_grey_ror_0",
			"wh2_dlc10_hef_inf_the_scions_of_mathlann_ror_0",
			"wh2_dlc10_hef_inf_the_silverpelts_ror_0",
			"wh2_dlc10_hef_inf_the_storm_riders_ror_0",
			"wh2_dlc15_hef_inf_archers_ror_0",
			"wh2_dlc15_hef_mon_arcane_phoenix_ror_0",
			"wh2_dlc15_hef_mon_war_lions_of_chrace_ror_0"
		}
	},
	--------------------
	---- DARK ELVES ----
	--------------------
	["wh2_main_sc_def_dark_elves"] = {
		playable_factions = {
			["main_warhammer"] = {
				"wh2_main_def_naggarond",
				"wh2_main_def_har_ganeth",
				"wh2_main_def_cult_of_pleasure",
				"wh2_dlc11_def_the_blessed_dread",
				"wh2_main_def_hag_graef"
			},
			["wh2_main_great_vortex"] = {
				"wh2_main_def_naggarond",
				"wh2_main_def_har_ganeth",
				"wh2_main_def_cult_of_pleasure",
				"wh2_dlc11_def_the_blessed_dread",
				"wh2_main_def_hag_graef"
			}
		},
		units = {
			"wh2_dlc10_def_cav_knights_of_the_ebon_claw_ror_0",
			"wh2_dlc10_def_cav_raven_heralds_ror_0",
			"wh2_dlc10_def_cav_slaanesh_harvesters_ror_0",
			"wh2_dlc10_def_inf_blades_of_the_blood_queen_ror_0",
			"wh2_dlc10_def_inf_sisters_of_the_singing_doom_ror_0",
			"wh2_dlc10_def_inf_the_bolt_fiends_ror_0",
			"wh2_dlc10_def_inf_the_hellebronai_ror_0",
			"wh2_dlc10_def_mon_chill_of_sontar_ror_0",
			"wh2_dlc14_def_cav_scourgerunner_chariot_ror_0",
			"wh2_dlc14_def_inf_harpies_ror_0",
			"wh2_dlc14_def_mon_bloodwrack_medusa_ror_0"
		}
	},
	-----------------------
	---- VAMPIRE COAST ----
	-----------------------
	["wh2_dlc11_sc_cst_vampire_coast"] = {
		playable_factions = {
			["main_warhammer"] = {
				"wh2_dlc11_cst_noctilus",
				"wh2_dlc11_cst_pirates_of_sartosa",
				"wh2_dlc11_cst_the_drowned",
				"wh2_dlc11_cst_vampire_coast"
			},
			["wh2_main_great_vortex"] = {
				"wh2_dlc11_cst_noctilus",
				"wh2_dlc11_cst_pirates_of_sartosa",
				"wh2_dlc11_cst_the_drowned",
				"wh2_dlc11_cst_vampire_coast"
			}
		},
		units = {
			"wh2_dlc11_cst_inf_zombie_deckhands_mob_ror_0",
			"wh2_dlc11_cst_inf_zombie_gunnery_mob_ror_0",
			"wh2_dlc11_cst_cav_deck_droppers_ror_0",
			"wh2_dlc11_cst_mon_mournguls_ror_0",
			"wh2_dlc11_cst_mon_rotting_prometheans_gunnery_mob_ror",
			"wh2_dlc11_cst_inf_deck_gunners_ror_0",
			"wh2_dlc11_cst_inf_depth_guard_ror_0",
			"wh2_dlc11_cst_mon_necrofex_colossus_ror_0"
		}
	},
	-------------------
	---- LIZARDMEN ----
	-------------------
	["wh2_main_sc_lzd_lizardmen"] = {
		playable_factions = {
			["main_warhammer"] = {
				"wh2_main_lzd_hexoatl",
				"wh2_main_lzd_last_defenders",
				"wh2_main_lzd_tlaqua",
				"wh2_dlc12_lzd_cult_of_sotek",
				"wh2_main_lzd_itza",
				"wh2_dlc17_lzd_oxyotl"
			},
			["wh2_main_great_vortex"] = {
				"wh2_main_lzd_hexoatl",
				"wh2_main_lzd_last_defenders",
				"wh2_main_lzd_tlaqua",
				"wh2_dlc12_lzd_cult_of_sotek",
				"wh2_main_lzd_itza",
				"wh2_dlc17_lzd_oxyotl"
			}
		},
		units = {
			"wh2_dlc12_lzd_cav_cold_one_spearriders_ror_0",
			"wh2_dlc12_lzd_cav_ripperdactyl_riders_ror_0",
			"wh2_dlc12_lzd_cav_terradon_riders_ror_0",
			"wh2_dlc12_lzd_inf_saurus_warriors_ror_0",
			"wh2_dlc12_lzd_inf_skink_red_crested_ror_0",
			"wh2_dlc12_lzd_inf_temple_guards_ror_0",
			"wh2_dlc12_lzd_mon_ancient_stegadon_ror_0",
			"wh2_dlc12_lzd_mon_salamander_pack_ror_0",
			"wh2_dlc13_lzd_mon_razordon_pack_ror_0",
			"wh2_dlc13_lzd_mon_sacred_kroxigors_ror_0",
			"wh2_dlc13_lzd_mon_dread_saurian_ror_0",
			"wh2_dlc17_lzd_mon_carnosaur_ror_0",
			"wh2_dlc17_lzd_mon_coatl_ror_0",
			"wh2_dlc17_lzd_mon_troglodon_ror_0"
		}
	},
	----------------
	---- SKAVEN ----
	----------------
	["wh2_main_sc_skv_skaven"] = {
		playable_factions = {
			["main_warhammer"] = {
				"wh2_main_skv_clan_mors",
				"wh2_main_skv_clan_skyre",
				"wh2_main_skv_clan_pestilens",
				"wh2_dlc09_skv_clan_rictus",
				"wh2_main_skv_clan_eshin",
				"wh2_main_skv_clan_moulder"
			},
			["wh2_main_great_vortex"] = {
				"wh2_main_skv_clan_mors",
				"wh2_main_skv_clan_skyre",
				"wh2_main_skv_clan_pestilens",
				"wh2_dlc09_skv_clan_rictus",
				"wh2_main_skv_clan_eshin",
				"wh2_main_skv_clan_moulder"
			}
		},
		units = {
			"wh2_dlc12_skv_art_warp_lightning_cannon_ror_0",
			"wh2_dlc12_skv_inf_clanrats_ror_0",
			"wh2_dlc12_skv_inf_plague_monk_censer_bearer_ror_0",
			"wh2_dlc12_skv_inf_ratling_gun_ror_0",
			"wh2_dlc12_skv_inf_stormvermin_ror_0",
			"wh2_dlc12_skv_inf_warplock_jezzails_ror_0",
			"wh2_dlc12_skv_veh_doom_flayer_ror_0",
			"wh2_dlc12_skv_veh_doomwheel_ror_0",
			"wh2_dlc14_skv_inf_death_runners_ror_0",
			"wh2_dlc14_skv_inf_eshin_triads_ror_0",
			"wh2_dlc14_skv_inf_poison_wind_mortar_ror_0",
			"wh2_dlc16_skv_mon_rat_ogres_ror_0",
			"wh2_dlc16_skv_mon_rat_ogre_mutant_ror_0",
			"wh2_dlc16_skv_mon_hell_pit_abomination_ror_0"
		}
	},
	------------------
	--- WOOD ELVES ---
	------------------
	["wh_dlc05_sc_wef_wood_elves"] = {
		playable_factions = {
			["main_warhammer"] = {
				"wh_dlc05_wef_wood_elves",
				"wh_dlc05_wef_argwylon",
				"wh2_dlc16_wef_sisters_of_twilight",
				"wh2_dlc16_wef_drycha"
			},
			["wh2_main_great_vortex"] = {
				"wh2_dlc16_wef_sisters_of_twilight"
			}
		},
		units = {
			"wh_pro04_wef_inf_eternal_guard_ror_0",
			"wh_pro04_wef_inf_wardancers_ror_0",
			"wh_pro04_wef_inf_waywatchers_ror_0",
			"wh_pro04_wef_cav_wild_riders_ror_0",
			"wh_pro04_wef_inf_wildwood_rangers_ror_0",
			"wh_pro04_wef_mon_treekin_ror_0",
			"wh2_dlc16_wef_inf_dryads_ror_0",
			"wh2_dlc16_wef_mon_zoats_ror_0",
			"wh2_dlc16_wef_cav_great_stag_knights_ror_0"
		}
	},
	------------------
	---- BEASTMEN ----
	------------------
	["wh_dlc03_sc_bst_beastmen"] = {
		playable_factions = {
			["main_warhammer"] = {
				"wh_dlc03_bst_beastmen",
				"wh_dlc05_bst_morghur_herd",
				"wh2_dlc17_bst_malagor",
				"wh2_dlc17_bst_taurox"
			},
			["wh2_main_great_vortex"] = {
				"wh2_dlc17_bst_taurox"
			}
		},
		units = {
			"wh_pro04_bst_inf_bestigor_herd_ror_0",
			"wh_pro04_bst_inf_centigors_ror_0",
			"wh_pro04_bst_inf_gor_herd_ror_0",
			"wh_pro04_bst_inf_minotaurs_ror_0",
			"wh_pro04_bst_inf_ungor_spearmen_ror_0",
			"wh_pro04_bst_inf_cygor_ror_0",
			"wh2_dlc17_bst_inf_centigors_ror_1",
			"wh2_dlc17_bst_mon_ghorgon_ror_0",
			"wh2_dlc17_bst_mon_jabberslythe_ror_0"
		}
	}
};

core:add_listener(
	"ROR_ScriptEventGlobalCampaignManagerCreated",
	"ScriptEventGlobalCampaignManagerCreated",
	true,
	function(context)
		Add_ROR_Locks();
	end,
	false
);

function Add_ROR_Locks()
	output_ror("########## ADDING R.O.R LOCKS ##########");
	local campaign_key = "main_warhammer";
	
	if cm:model():campaign_name("wh2_main_great_vortex") then
		campaign_key = "wh2_main_great_vortex";
	end
	
	for subculture, data in pairs(REGIMENTS_OF_RENOWN) do
		output_ror("Checking for subculture: "..subculture);
		local human_player = "";
		
		if data.playable_factions[campaign_key] ~= nil then
			for i = 1, #data.playable_factions[campaign_key] do
				local faction_key = data.playable_factions[campaign_key][i];
				
				if cm:model():world():faction_exists(faction_key) == true then
					local faction_obj = cm:model():world():faction_by_key(faction_key);
					
					if faction_obj:is_null_interface() == false and faction_obj:is_human() == true then
						human_player = faction_key;
						output_ror("\tFound human player: "..human_player);
						break;
					end
				end
			end
		end
		
		if human_player ~= "" then
			Lock_Units_In_Subculture_For_Everyone_But(subculture, human_player);
		else
			output_ror("Didn't find human in this subculture, finding another faction...");
			local subculture_faction_not_dead = "";
			local subculture_faction = "";
			local faction_list = cm:model():world():faction_list();
			
			for i = 0, faction_list:num_items() - 1 do
				local current_faction = faction_list:item_at(i);
				
				if current_faction:is_null_interface() == false and current_faction:subculture() == subculture and current_faction:is_quest_battle_faction() == false then
					if subculture_faction == "" then
						subculture_faction = current_faction:name();
					end
					
					if current_faction:is_dead() == false then
						if subculture_faction_not_dead == "" then
							subculture_faction_not_dead = current_faction:name();
						end
					end
				end
			end
			
			output_ror("\tBest Matches -");
			output_ror("\t\tFirst Alive Faction: "..subculture_faction_not_dead);
			output_ror("\t\tFirst Existing Faction: "..subculture_faction);
			
			if subculture_faction_not_dead ~= "" then
				Lock_Units_In_Subculture_For_Everyone_But(subculture, subculture_faction_not_dead);
			elseif subculture_faction ~= "" then
				Lock_Units_In_Subculture_For_Everyone_But(subculture, subculture_faction);
			else
				output_ror("ERROR: Didn't lock ROR for subculture [" .. subculture .. "] with ROR. Is this an old save game where the subculture does not exist?");
			end
		end
	end
	
	tomb_king_ror_locks();
	vampire_coast_ror_locks();
	tehenhauin_ror_locks();
	output_ror("######################################");
end

function Lock_Units_In_Subculture_For_Everyone_But(subculture, faction)
	output_ror("---- Locking ROR ----");
	output_ror("Selecting '"..faction.."' as the main faction of the '"..subculture.."' subculture!");
	
	local faction_list = cm:model():world():faction_list();
	
	for i = 0, faction_list:num_items() - 1 do
		local current_faction = faction_list:item_at(i);
		local fac_name = current_faction:name();
		local fac_subculture = current_faction:subculture();
		
		if current_faction:is_human() == false then -- ROR should never be locked for a human
			if current_faction:is_quest_battle_faction() == false then -- Don't bother locking ROR for QB factions
				if fac_name ~= faction then
					if fac_subculture == subculture then
						if REGIMENTS_OF_RENOWN[subculture] ~= nil then
							output_ror("Locking "..#REGIMENTS_OF_RENOWN[subculture].units.." ROR units for "..fac_name);
							
							for j = 1, #REGIMENTS_OF_RENOWN[subculture].units do
								output_ror("\tLocking Unit: "..REGIMENTS_OF_RENOWN[subculture].units[j]);
								cm:add_event_restricted_unit_record_for_faction(REGIMENTS_OF_RENOWN[subculture].units[j], fac_name);
							end
						end
					end
				end
			end
		end
	end
	output_ror("");
end

-- TOMB KINGS
function tomb_king_ror_locks()
	output_ror("tomb_king_ror_locks()");
	if cm:is_new_game() then
		local tk_factions = {"wh2_dlc09_tmb_khemri", "wh2_dlc09_tmb_followers_of_nagash", "wh2_dlc09_tmb_lybaras", "wh2_dlc09_tmb_exiles_of_nehek"};
		
		for i = 1, #tk_factions do
			-- Unlocked via Rite
			cm:add_event_restricted_unit_record_for_faction("wh2_dlc09_tmb_art_casket_of_souls_0", tk_factions[i], "wh2_dlc09_lock_casket_of_souls");
			-- Unlocked via Crafting
			cm:add_event_restricted_unit_record_for_faction("wh2_dlc09_tmb_mon_carrion_ror", tk_factions[i], "wh2_dlc09_lock_ror_crafting");
			cm:add_event_restricted_unit_record_for_faction("wh2_dlc09_tmb_inf_nehekhara_warriors_ror", tk_factions[i], "wh2_dlc09_lock_ror_crafting");
			cm:add_event_restricted_unit_record_for_faction("wh2_dlc09_tmb_cav_nehekhara_horsemen_ror", tk_factions[i], "wh2_dlc09_lock_ror_crafting");
			cm:add_event_restricted_unit_record_for_faction("wh2_dlc09_tmb_cav_necropolis_knights_ror", tk_factions[i], "wh2_dlc09_lock_ror_crafting");
		end
	end
	
	core:add_listener(
		"tomb_king_ror_unlock",
		"RitualCompletedEvent",
		true,
		function(context)
			tomb_king_ror_unlock(context:performing_faction(), context:ritual():ritual_key());
		end,
		true
	);
end

function tomb_king_ror_unlock(faction, ritual_key)
	if faction:is_human() == true then
		local faction_key = faction:name();
		
		if ritual_key == "wh2_dlc09_ritual_tmb_tahoth" then
			cm:remove_event_restricted_unit_record_for_faction("wh2_dlc09_tmb_art_casket_of_souls_0", faction_key);
		elseif ritual_key == "wh2_dlc09_ritual_crafting_tmb_carrion" then
			cm:remove_event_restricted_unit_record_for_faction("wh2_dlc09_tmb_mon_carrion_ror", faction_key);
		elseif ritual_key == "wh2_dlc09_ritual_crafting_tmb_nehekhara_warriors" then
			cm:remove_event_restricted_unit_record_for_faction("wh2_dlc09_tmb_inf_nehekhara_warriors_ror", faction_key);
		elseif ritual_key == "wh2_dlc09_ritual_crafting_tmb_nehekhara_horsemen" then
			cm:remove_event_restricted_unit_record_for_faction("wh2_dlc09_tmb_cav_nehekhara_horsemen_ror", faction_key);
		elseif ritual_key == "wh2_dlc09_ritual_crafting_tmb_necropolis_knights" then
			cm:remove_event_restricted_unit_record_for_faction("wh2_dlc09_tmb_cav_necropolis_knights_ror", faction_key);
		end
	end
end

-- VAMPIRE COAST
function vampire_coast_ror_locks()
	output_ror("vampire_coast_ror_locks()");
	if cm:is_new_game() then
		local vc_factions = {"wh2_dlc11_cst_the_drowned", "wh2_dlc11_cst_pirates_of_sartosa", "wh2_dlc11_cst_vampire_coast", "wh2_dlc11_cst_noctilus"};
		
		for i = 1, #vc_factions do
			-- Unlocked via Rite
			cm:add_event_restricted_unit_record_for_faction("wh2_dlc11_cst_art_queen_bess", vc_factions[i], "wh2_dlc11_lock_queen_bess");
		end
	end
	core:add_listener(
		"vampire_coast_ror_unlock",
		"RitualCompletedEvent",
		true,
		function(context)
			vampire_coast_ror_unlock(context:performing_faction(), context:ritual():ritual_key());
		end,
		true
	);
end

function vampire_coast_ror_unlock(faction, ritual_key)
	if faction:is_human() == true then
		local faction_key = faction:name();
		
		if ritual_key == "wh2_dlc11_ritual_cst_queens_cannon" then
			cm:remove_event_restricted_unit_record_for_faction("wh2_dlc11_cst_art_queen_bess", faction_key);
		end
	end
end

-- TEHENHAUIN
function tehenhauin_ror_locks()
	output_ror("tehenhauin_ror_locks()");
	local tehenhauin_faction = "wh2_dlc12_lzd_cult_of_sotek";
	
	if cm:is_new_game() then
	
		local lzd_ror_units = {
			"wh2_dlc12_lzd_cav_cold_one_spearriders_ror_0",
			"wh2_dlc12_lzd_cav_ripperdactyl_riders_ror_0",
			"wh2_dlc12_lzd_cav_terradon_riders_ror_0",
			"wh2_dlc12_lzd_inf_saurus_warriors_ror_0",
			"wh2_dlc12_lzd_inf_skink_red_crested_ror_0",
			"wh2_dlc12_lzd_inf_temple_guards_ror_0",
			"wh2_dlc12_lzd_mon_ancient_stegadon_ror_0",
			"wh2_dlc12_lzd_mon_salamander_pack_ror_0"
		}
	
		for i = 1, #lzd_ror_units do
		-- Unlocked via Sacrifices to Sotek
		cm:add_event_restricted_unit_record_for_faction(lzd_ror_units[i], tehenhauin_faction, "wh2_dlc12_lock_ror_sotek");
		end
	end
	
	
	core:add_listener(
		"tehenhauin_ror_unlock",
		"RitualCompletedEvent",
		true,
		function(context)			
			tehenhauin_ror_unlock(context:performing_faction(), context:ritual():ritual_key());
		end,
		true
	);
end

function tehenhauin_ror_unlock(faction, ritual_key)
	if faction:is_human() == true then
		local faction_key = faction:name();
		
		if ritual_key == "wh2_dlc12_tehenhauin_sacrifice_tier2_ror_pok_hopak_cohort" then
			cm:remove_event_restricted_unit_record_for_faction("wh2_dlc12_lzd_cav_cold_one_spearriders_ror_0", faction_key);
		elseif ritual_key == "wh2_dlc12_tehenhauin_sacrifice_tier2_ror_colossadon_hunters" then
			cm:remove_event_restricted_unit_record_for_faction("wh2_dlc12_lzd_cav_ripperdactyl_riders_ror_0", faction_key);
		elseif ritual_key == "wh2_dlc12_tehenhauin_sacrifice_tier3_ror_pahuax_sentinels" then
			cm:remove_event_restricted_unit_record_for_faction("wh2_dlc12_lzd_cav_terradon_riders_ror_0", faction_key);
		elseif ritual_key == "wh2_dlc12_tehenhauin_sacrifice_tier1_ror_legion_of_chaqua" then
			cm:remove_event_restricted_unit_record_for_faction("wh2_dlc12_lzd_inf_saurus_warriors_ror_0", faction_key);
		elseif ritual_key == "wh2_dlc12_tehenhauin_sacrifice_tier1_ror_cohort_of_sotek" then
			cm:remove_event_restricted_unit_record_for_faction("wh2_dlc12_lzd_inf_skink_red_crested_ror_0", faction_key);
		elseif ritual_key == "wh2_dlc12_tehenhauin_sacrifice_tier4_ror_star_chamber_guardians" then
			cm:remove_event_restricted_unit_record_for_faction("wh2_dlc12_lzd_inf_temple_guards_ror_0", faction_key);
		elseif ritual_key == "wh2_dlc12_tehenhauin_sacrifice_tier5_ror_the_thunderous_one" then
			cm:remove_event_restricted_unit_record_for_faction("wh2_dlc12_lzd_mon_ancient_stegadon_ror_0", faction_key);
		elseif ritual_key == "wh2_dlc12_tehenhauin_sacrifice_tier3_ror_the_umbral_tide" then
			cm:remove_event_restricted_unit_record_for_faction("wh2_dlc12_lzd_mon_salamander_pack_ror_0", faction_key);
		end
	end
end

local show_debug_output_ror = false;
function output_ror(text)
	if show_debug_output_ror then
		out(text);
	end
end